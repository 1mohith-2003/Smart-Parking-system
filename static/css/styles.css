async function fetchSpots(){
  const res = await fetch('/api/spots');
  const data = await res.json();
  const container = document.getElementById('spots');
  container.innerHTML = '';
  data.forEach(s => {
    const div = document.createElement('div');
    div.className = 'spot ' + (s.occupied ? 'occupied' : 'free');
    div.dataset.id = s.id;
    div.innerHTML = `<h3>${s.spot_name}</h3><p>${s.occupied ? 'Occupied' : 'Free'}</p>`;
    div.onclick = () => toggleSpot(s.id, s.occupied ? 0 : 1);
    container.appendChild(div);
  });
}

async function toggleSpot(id, newState){
  await fetch(`/api/spots/${id}`, {
    method: 'POST',
    headers: {'Content-Type':'application/json'},
    body: JSON.stringify({occupied: newState})
  });
  fetchSpots();
}

document.getElementById('refresh').addEventListener('click', fetchSpots);

window.onload = fetchSpots;
